\chapter{The Outlier Anchor Node Placements}
\label{chap:outliers}
As seen in the previous chapter, there are some anchor node placements that are significantly worse than the average case.   In this chapter, we explore in more detail the cause of these outliers and more importantly, is this condition detectable in the real world.

\section{The Cause}
Figure~\ref{fig:outlier1} shows a network difference plot of an example outlier anchor node placement for a random network. A line is drawn between the real location and the calculated location for each individual node.  For comparison, Figure~\ref{fig:normal1} is a randomly chosen non-outlier case, where the node difference lines are short, representing low localization error.  However, in the outlier case, the node difference lines criss-cross the network along a clear, single angle.  This representation suggests the reflection component of the final linear transformation is to blame for the extremely poor results.

\begin{figure}
  \centering
	\subfloat[An outlier network difference]{\label{fig:outlier1}
		\includegraphics[width=\figurewidth\textwidth]{outliers/AS6/AS6NetworkDiff9}}
\\
	\subfloat[A normal network difference]{\label{fig:normal1}
		\includegraphics[width=\figurewidth\textwidth]{outliers/normal1}}		
	\label{fig:outliernetworkdiff}
	\caption{}
\end{figure}

\section{Avoid Outliers}
\label{sec:reflection}
Unfortunately, simply disabling the reflection component of the Procrustes transformation algorithm does not solve the problem.  The output of the Procrustes algorithm is a linear transformation which includes a rotation or reflection matrix, as discussed in Section~\ref{sec:procrustes}.  If the determinant of that matrix is +1, then the resulting transformation has a rotation, with an angle as in Equation~\ref{eqn:rotmatrix}.  

\begin{equation}
	\det{(T)}=+1 \Rightarrow ~Rotation ~with ~T=
	\begin{bmatrix}
	\cos{\theta} & -\sin{\theta} \\ 
	\sin{\theta} & \cos{\theta}\end{bmatrix}
	\label{eqn:rotmatrix} 
\end{equation}

If the determinant is -1, then the resulting transformation has reflection component, across a line at an angle as shown in Equation~\ref{eqn:refmatrix}. 

\begin{equation}
	\det{(T)}=-1 \Rightarrow ~Reflection ~with ~T=
	\begin{bmatrix}
	\cos{2{\theta}} & \sin{2{\theta}} \\ 
	\sin{2{\theta}} & -\cos{2{\theta}}\end{bmatrix}
	\label{eqn:refmatrix} 
\end{equation}

Figure~\ref{fig:rotref} shows the rotation and reflection distributions of two different networks, for a random set of anchor sets for each network.  In both networks, and with consistency across others, the bulk of the data points have the same angle of either rotation or reflection, while the outliers have the opposite property with a wide variance in the angle.  However, between networks, it is not consistently either rotation or reflection.  Therefore, relying on the determinant of the transformation is not a sufficient indicator of a network planner knowing that an outlier case has been hit and thus the localization results are essentially useless.

\begin{figure}
  \centering
	\subfloat[]{\label{fig:rotref1}
		\includegraphics[width=\figurewidth\textwidth]{rotref1}}
\\
	\subfloat[]{\label{fig:rotref2}
		\includegraphics[width=\figurewidth\textwidth]{rotref2}}		
	\caption{Rotation and reflection versus location error}	
	\label{fig:rotref}
\end{figure}

The Procrustes algorithm itself provides a measure of the dissimilarity.  Specifically, it is the minimized value of sum of squared errors\cite{procrustes-matlab}.  As shown in Figure~\ref{fig:dissimilarity}, it is not a good indicator of the transformation as it pertains to the entire network.  This is because the Procrustes algorithm is only performed on the anchor nodes themselves and for those nodes themselves, the transformation is good.

\begin{figure}
  \centering
	\includegraphics[width=\figurewidth\textwidth]{dissimilarity}
	\caption{Procrustes dissimilarity measure}	
	\label{fig:dissimilarity}
\end{figure}

As shown in Figure~\ref{fig:rotref}, each network has a \emph{natural} rotation or reflection angle to provide accurate localization.  As the linear transformation moves away from that angle, the errors increase.  Unfortunately, there is no direct indicator that a particular anchor set generates a transformation with an incorrect angle.  Therefore, network planners must avoid all anchor sets that could potentially generate such an angle.  As shown in the Section~\ref{sec:anchorTriangle}, the minimum height of the triangle formed by the anchor nodes are a good indicator of the possibility of a poor transformation angle.  

\section{Outlier Indicators} 

This section shows that the minimum height of the anchor node triangle is a good indicator of the outlier case more rigorously then previously shown.  Further, we provide a good metric for how flat of a triangle is too flat.

\begin{figure}
  \centering
	\includegraphics[width=\figurewidth\textwidth]{HeightIndicator}
	\caption[Minimum anchor triangle heights]{Minimum anchor triangle heights, with confidence intervals grouped in intervals of 0.1r}	
	\label{fig:heightIndicator}
\end{figure}

